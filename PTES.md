![](https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202306051016521.png)

## 什么是渗透测试?

> 渗透测试(**Penetration Test**):是完全模拟黑客可能使用的攻击技术和漏洞发现技术,对目标系统的安全做深入的探测,发现系统最薄弱的环节.渗透测试能够直观的让管理人员知道自己网络所面临的问题
>
> **渗透测试是一种专业的安全服务**

1. **国际渗透测试标准:OWASP**
2. **国际渗透测试标准:OSSTMM**
3. **国际渗透测试流程:PTES**
4. **Web安全测试规范**

PTES的意义体现在以下几个方面：

1. 统一标准：PTES通过定义一套统一的渗透测试执行标准，对渗透测试从前期筹划到测试报告的全过程进行了详细规范。这使得渗透测试工作不再依赖于个人经验和偏好，提高了测试活动的一致性和可比性。
2. 高效合理：PTES明确了渗透测试的阶段、任务和要求，以及每个阶段中应执行的具体工作。它提供了一种系统性的方法，帮助安全专业人员在渗透测试过程中更加高效地进行任务分解、资源规划和进度控制。
3. 全面覆盖：PTES涵盖了多个方面的内容，包括前期信息收集、目标确定、威胁建模、漏洞识别、攻击实施、后渗透操作等。它考虑了渗透测试的各个环节和关键要素，以确保测试工作全面而详尽。
4. 安全保障：PTES的目标之一是确保渗透测试过程的安全性和合规性。它鼓励测试人员遵守法律法规，并在测试活动中采取必要的保护措施，以防止对目标系统和数据的不必要风险和损害。
5. 提升信任：由于PTES是一个公认的行业标准，它为渗透测试提供了一种受信任的指导框架。它使渗透测试的结果更具可信度和可靠性，提高了测试报告的权威性和可信度，有助于与客户、审计机构和监管部门建立良好的合作关系。

{% quot PTES的起源可以追溯到2012年，当时由一群来自渗透测试社区的安全专业人员共同合作创建。他们的目标是建立一个通用、全面的渗透测试标准，以填补当时市场上存在的标准缺失和执行不一致的问题。经过多次讨论和协商，他们最终形成了PTES，并于2013年发布了第一版。 %}

## 渗透测试中必须要需要的声明

### 保密协议

![保密协议书-1](https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202304071527163.jpg)

![保密协议书-2](https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202304071527249.jpg)

### 渗透测试授权书

**开展渗透测试工作前,必须与测试单位签订《渗透测试授权书》**

![image-20230402203509016](https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202304022035079.png)

### 风险告知书

![4. 风险告知书-1](https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202304071528385.jpg)

![4. 风险告知书-2](https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202304071528914.jpg)

![4. 风险告知书-3](https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202304071528913.jpg)

![4. 风险告知书-4](https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202304071529794.jpg)

## 渗透测试与入侵的区别

渗透测试:以安全为基本原则，通过攻击者以及防御者的角度去分析目标所存在的安全隐患以及脆弱性，以保护系统安全为最终目标。

入侵:通过各种方法，甚至破坏性的操作，来获取系统权限以及各种敏感信息。

## 一般渗透测试流程(PTES)

![渗透测试流程](https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202304022046884.png)

![image-20240218195506811](https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202402181955906.png)

1. 信息收集：我们需要收集目标系统的各种信息，包括使用的CMS框架、中间件版本、后端语言、banner指纹和子域名等。这些信息可以帮助我们了解系统架构和潜在的漏洞。
2. 漏洞探测：我们会利用自动化漏洞扫描工具，如AWVS、Nessus等，进行漏洞扫描。通用性的工具如AWVS和Nessus可以检测各种常见漏洞，而专一性的工具如JoomScan、WPScan、Droopescan、Drupwn则针对特定的CMS框架进行漏洞探测。
3. 攻击实施：我们会使用常见的手动攻击手法，如OWASP Top 10漏洞或Google Hacking等，来探测目标系统是否存在可利用的漏洞。通过尝试利用历史漏洞的手法，我们可以评估系统的安全性。
4. 后渗透操作：一旦我们成功进入系统，我们可以尝试提升权限，并收集服务器内的敏感信息，如网站配置文件、数据库数据。我们还可能尝试在局域网内进行横向移动，并清除攻击的日志和痕迹，使用各种工具来实现这些操作。
5. 维持访问：为了长期保持对服务器的权限，我们可以使用后门程序等技术，以确保我们可以随时访问系统。
6. 报告编写：最后，我们会编写相关报告，包括发现的漏洞及修复建议，并提交给委托方，即"甲方爸爸"，以便他们采取相应的措施加强系统安全。

![image-20230402203110831](https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202304022031858.png)

**测试方法:**

1. 黑盒测试
   - 它是指在测试过程中，测试人员没有或只有很少的关于被测试系统的内部结构、工作原理和代码实现等信息。测试人员只能通过系统对外部接口的输入和输出来判断系统是否存在安全漏洞。 黑盒测试通常是在测试人员不了解系统内部结构和源代码的情况下进行的，这种测试方法更加贴近于实际的攻击情况，因为攻击者通常也无法获得系统的内部信息。黑盒测试可以模拟攻击者的行为来测试系统的安全性，包括但不限于输入验证、身份认证、访问控制、数据加密、会话管理、错误处理等方面。 黑盒测试可以帮助组织评估其系统的安全性，以及找出其中的弱点和漏洞，以便采取措施加以弥补。同时，黑盒测试也可以帮助组织提高其系统的安全性，以保护系统中的敏感信息不被攻击者获取。
2. 白盒测试
   - 它是指在测试过程中，测试人员拥有被测试系统的内部结构、工作原理和代码实现等信息。测试人员可以利用这些信息来测试系统是否存在安全漏洞。 白盒测试通常是在测试人员已经了解系统内部结构和源代码的情况下进行的，这种测试方法可以更加全面地检查系统的安全性。白盒测试可以检查系统的代码实现是否符合安全标准和最佳实践，包括但不限于输入验证、身份认证、访问控制、数据加密、会话管理、错误处理等方面。 白盒测试可以帮助组织评估其系统的安全性，以及找出其中的弱点和漏洞，以便采取措施加以弥补。同时，白盒测试也可以帮助组织提高其系统的安全性，以保护系统中的敏感信息不被攻击者获取。白盒测试的优势在于可以发现一些黑盒测试无法发现的细节性问题，但它需要测试人员具备丰富的技术和经验。
3. 灰盒测试
   - 是一种介于黑盒测试和白盒测试之间的测试方法，它是指在测试过程中，测试人员有一定的关于被测试系统的内部结构、工作原理和代码实现等信息，但这些信息通常不够详细或完整。测试人员可以利用这些信息来测试系统是否存在安全漏洞，同时也需要模拟攻击者的行为来测试系统的安全性。 灰盒测试通常是在测试人员了解系统的某些部分内部结构和源代码的情况下进行的，但测试人员通常无法完全了解系统的所有部分。灰盒测试可以结合黑盒测试和白盒测试的优势，既可以测试系统的输入输出接口，又可以检查系统的代码实现是否符合安全标准和最佳实践。同时，灰盒测试也可以模拟攻击者的行为来测试系统的安全性。 灰盒测试可以帮助组织评估其系统的安全性，以及找出其中的弱点和漏洞，以便采取措施加以弥补。同时，灰盒测试也可以帮助组织提高其系统的安全性，以保护系统中的敏感信息不被攻击者获取。灰盒测试需要测试人员具备丰富的技术和经验，以便在了解系统的一定部分内部结构和源代码的情况下，能够全面地测试系统的安全性。
4. 人工测试
   - 它是指由专业的安全测试人员通过手动操作、模拟攻击等方式来测试系统的安全性。测试人员会利用各种技术手段和攻击方法来检测系统的安全性，并尝试发现系统中可能存在的安全漏洞、弱点或潜在风险。 信息安全人工测试通常包括黑盒测试、白盒测试和灰盒测试等多种测试方法，测试人员可以根据系统的特点和测试目标选择合适的测试方法。测试人员需要具备丰富的安全知识和技能，能够模拟攻击者的行为来测试系统的安全性，并能够准确地分析系统中可能存在的安全风险和漏洞。 信息安全人工测试可以帮助组织评估其系统的安全性，以及找出其中的弱点和漏洞，以便采取措施加以弥补。同时，信息安全人工测试也可以帮助组织提高其系统的安全性，以保护系统中的敏感信息不被攻击者获取。信息安全人工测试需要测试人员具备丰富的技术和经验，以便能够全面地测试系统的安全性，并提供有效的测试报告和建议。
5. 工具扫描
   - 它是指利用专业的安全扫描工具，对系统的漏洞、弱点等进行自动化扫描，以检测系统是否存在安全漏洞。信息安全工具扫描通常包括漏洞扫描、端口扫描、Web应用程序扫描等多种扫描方法，测试人员可以根据系统的特点和测试目标选择合适的扫描方法。 信息安全工具扫描可以帮助组织快速地扫描系统的安全性，发现系统中可能存在的安全漏洞、弱点或潜在风险。扫描工具可以自动化地进行扫描，减轻测试人员的工作量，并提高测试的效率。同时，扫描工具还可以提供详细的扫描报告和建议，以帮助组织了解系统的安全状况，并采取相应的措施加以弥补。 虽然信息安全工具扫描可以快速地发现系统中的安全漏洞，但它也存在一定的局限性。扫描工具可能会误报或漏报某些漏洞，因此测试人员需要对扫描结果进行人工验证。同时，扫描工具只能检测已知的漏洞，对于新型的或未知的漏洞可能无法进行检测。因此，信息安全工具扫描应该与其他测试方法结合使用，以提高测试的准确性和全面性。
6. 漏洞验证
   - 它是指在发现系统中存在安全漏洞后，通过模拟攻击等方式来验证漏洞的存在性和危害性。漏洞验证的过程通常包括漏洞重现、漏洞利用、攻击模拟和影响评估等步骤。 在进行信息安全漏洞验证之前，测试人员需要对漏洞进行详细的分析和确认，确定其存在性和危害性，以避免对系统造成不必要的损失。漏洞验证需要测试人员具备丰富的安全知识和技能，能够模拟攻击者的行为来测试系统的安全性，并能够准确地分析漏洞的危害性和可能的攻击手段。 信息安全漏洞验证可以帮助组织评估其系统的安全性，以及找出其中的弱点和漏洞，以便采取措施加以弥补。同时，漏洞验证也可以帮助组织提高其系统的安全性，以保护系统中的敏感信息不被攻击者获取。漏洞验证的结果可以帮助组织更好地了解漏洞的危害性，并采取相应的措施加以修复和防范。 需要注意的是，在进行信息安全漏洞验证的过程中，测试人员需要遵守相关的法律法规和道德规范，不得进行未授权的攻击行为，以免对系统造成不必要的损失。
7. 漏洞演示
   - 它是指在验证系统中存在安全漏洞后，通过演示来展示漏洞的存在性、危害性和攻击手段。漏洞演示通常包括利用漏洞进行攻击、获取敏感信息、篡改数据等多种攻击场景，以呈现漏洞的真实危害性，并帮助组织更好地了解漏洞的危害性和防范措施。 信息安全漏洞演示需要演示人员具备丰富的安全知识和技能，能够准确地模拟攻击者的行为，演示攻击的全过程，并能够解释漏洞的危害性和防范措施。漏洞演示需要演示人员提前进行充分的准备和测试，以确保演示的顺利进行，并避免因漏洞演示而对系统造成不必要的损失。 信息安全漏洞演示可以帮助组织更好地了解漏洞的危害性和攻击手段，以及采取相应的措施加以修复和防范。漏洞演示可以提高组织对安全风险的认识和意识，增强组织的安全意识和防范能力。同时，漏洞演示还可以帮助组织评估其信息安全的水平和风险状况，制定和完善相应的安全策略和规范，以保障组织的信息安全。
8. 横向渗透
   - 横向渗透（Lateral Movement）是指攻击者在已经入侵了一台或多台受害者主机之后，通过利用系统漏洞、弱口令等方式，向网络中其他主机进行攻击，并在网络中横向移动，以获取更多的系统权限和敏感信息。攻击者通常会使用恶意软件、后门程序等手段来进行横向渗透，以避免被系统安全软件和检测机制发现和拦截。 横向渗透对于攻击者而言非常重要，因为攻击者可以通过横向渗透在网络中获得更多的权限和敏感信息。攻击者通过横向渗透可以访问其他主机上的文件、数据库、邮件等敏感信息，甚至可以获取系统管理员的权限，从而进一步深入系统，控制整个网络。 为了防范横向渗透攻击，组织可以采取一些安全措施，如加强系统安全配置、及时更新补丁、使用强口令、限制用户权限、使用安全软件等。此外，组织还可以通过安全培训和意识提高等方式提高员工的安全意识，减少安全漏洞的发生。
9. 纵向渗透
   - 纵向渗透（Vertical Movement）是指攻击者在已经入侵了一台或多台受害者主机之后，通过利用系统漏洞或社交工程等手段，向网络中更高级别的主机或系统进行攻击，以获取更高级别的系统权限和敏感信息(**一句话概括:提权或者拿主控机器**)。攻击者通常会利用系统中的弱点和漏洞，来获取更高级别的权限和敏感信息，从而控制整个网络。 纵向渗透攻击通常是通过提升攻击者的权限来实现。攻击者可能会从普通用户的权限提升到管理员的权限，然后再提升到系统管理员的权限，最终控制整个网络。攻击者还可以通过利用社交工程等手段，获取高级别用户的账号和密码，从而进一步提升其权限。纵向渗透攻击的危害性非常大，因为攻击者可以通过提升权限来控制更多的系统资源和敏感信息，从而对受害组织造成更大的损失。 为了防范纵向渗透攻击，组织可以采取一些安全措施，如限制用户权限、加强系统安全配置、使用强口令、定期修改密码等。此外，组织还可以通过安全培训和意识提高等方式提高员工的安全意识，减少安全漏洞的发生。同时，组织还应该定期进行安全漏洞扫描和漏洞修复，以及加强日志的监控和分析，及时发现和防范纵向渗透攻击。

![横向渗透以及纵向渗透](https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202304022028948.png)

## 渗透测试价值

1. 帮助用户对目前自己的网络、系统、应用的缺陷有相对直观的认识和了解

2. 发现已知和未知的漏洞和风险,为漏洞修复和风险处置提供技术支撑
3. 给信息系统全面的体检,查找存在的风险及隐患,防患于未然

## PTES与靶场渗透实战的关系和应用

1. 目标设定：在使用靶场进行渗透实战之前，明确测试的目标和范围。根据PTES中的目标确定阶段，明确要测试的系统、应用或网络，以及测试的目的和限制。
2. 前期信息收集：使用PTES中的信息收集任务，收集关于靶场系统的相关信息。了解系统架构、主机信息、网络拓扑等，以帮助制定渗透测试策略和发现潜在的漏洞。
3. 漏洞识别与扫描：根据PTES中的漏洞识别任务，在靶场系统上执行漏洞扫描工具或手动探测，发现系统中存在的漏洞和弱点。根据扫描结果进一步分析风险和评估漏洞的严重程度。
4. 攻击实施：根据PTES中的攻击实施任务，选择合适的攻击方式和技术，对靶场系统进行渗透测试。这可能包括利用漏洞进行远程代码执行、身份认证绕过、敏感信息泄露等。注意在进行攻击实施前，确保事先取得合法授权并了解靶场系统的特殊限制和要求。
5. 后渗透操作：按照PTES中的后渗透操作任务，深入系统内部，尝试横向移动和权限提升。在靶场系统中模拟现实环境下真实的攻击行为，查看是否能够获取敏感信息、控制关键系统等。同时，注意在测试过程中留下合适的日志记录，以便分析和报告。
6. 测试报告：根据PTES中的测试报告要求，整理渗透测试的结果和发现。包括对漏洞的描述、风险评估、建议的修复措施等。确保报告清晰明了，便于客户或相关人员理解，并根据需要提供技术支持和解释。